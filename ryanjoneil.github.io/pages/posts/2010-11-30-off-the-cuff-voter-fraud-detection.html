title: Off-the-Cuff Voter Fraud Detection
author: Ryan J. O'Neil
date: 30-11-2010
category: Data Science
lang: Python
description: Using the exponential distribution to interpret votes in a web survey.

{% extends "post.html" %}

{% block post %}

<p>Consider this scenario:  You run a contest that accepts votes from the general Internet population.  In order to encourage user engagement, you record any and all votes into a database over several days, storing nothing more than the competitor voted for, when each vote is cast, and a cookie set on the voter's computer along with their apparent IP addresses.  If a voter already has a recorded cookie set they are denied subsequent votes.  This way you can avoid requiring site registration, a huge turnoff for your users.  Simple enough.</p>

<p>
Unfortunately, some of the competitors are wily and attached to the idea of winning.  They go so far as programming or hiring bots to cast thousands of votes for them.  Your manager wants to know which votes are real and which ones are fake Right Now.  Given very limited time, and ignoring actions that you <i>could</i> have taken to avoid the problem, how can you tell apart sets of good votes from those that shouldn't be counted?</p>

<p>
One quick-and-dirty option involves comparing histograms of <a href="http://www.ehow.com/how_5417319_calculate-interarrival-time.html">interarrival times</a> for sets of votes.  Say you're concerned that all the votes during a particular period of time or from a given IP address might be fraudulent.  Put all the vote times you're concerned about into a list, sort them, and compute their differences:</p>

<pre><code class="py"># times is a list of datetime instances from vote records
times.sort(reversed=True)
interarrivals = [y-x for x, y in zip(times, times[1:]]
</code></pre>

<p>Now use matplotlib to <a href="http://matplotlib.sourceforge.net/users/pyplot_tutorial.html#working-with-text">display a histogram</a> of these.  Votes that occur naturally are likely to resemble an <a href="http://en.wikipedia.org/wiki/Exponential_distribution">exponential distribution</a> in their interarrival times.  For instance, here are interarrival times for all votes received in a contest:</p>

<p><center>
<img src="/static/images/2010/voter-fraud/all-votes.png"/><br/>
Interarrival times for all submissions
</center></p>

<p>This subset of votes is clearly fraudulent, due to the near determinism of their interarrival times.  This is most likely caused by the voting bot not taking random sleep intervals during voting.  It casts a vote, receives a response, clears its cookies, and repeats:</p>

<p><center>
<img src="/static/images/2010/voter-fraud/fraud-plot.png" width="320px"/><br/>
Interarrival times for clearly fraudulent votes
</center></p>

<p>
These votes, on the other hand, are most likely legitimate.  They exhibit a nice <a href="http://en.wikipedia.org/wiki/Erlang_distribution">Erlang</a> shape and appear to have natural interarrival times that one would expect:</p>

<p><center>
<img src="/static/images/2010/voter-fraud/not-fraud.png"/><br/>
Proper-looking interarrival times
</center></p>

<p>Of course this method is woefully inadequate for rigorous detection of voting fraud.  Ideally one would find a method to compute the probability that a set of votes is generated by a bot.  This is enough to inform quick, ad hoc decisions though.</p>

{% endblock %}
